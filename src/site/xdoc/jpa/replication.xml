<?xml version="1.0" encoding="iso-8859-1"?>
<document xmlns="http://maven.apache.org/XDOC/2.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/XDOC/2.0 http://maven.apache.org/xsd/xdoc-2.0.xsd">
    <properties>
        <title>JPA Datastore Replication</title>
    </properties>

    <body>
        <section name="JPA : Datastore Replication">
            <img src="../images/nucleus_extension.gif" border="0" alt=""/>
            <p>
                Many applications make use of multiple datastores. It is a common requirement to be
                able to replicate parts of one datastore in another datastore.
                Obviously, depending on the datastore, you could make use of the datastores own
                capabilities for replication. DataNucleus provides its own extension to JPA to
                allow replication from one datastore to another. This extension doesn't restrict you to
                using 2 datastores of the same type. You could replicate from RDBMS to XML for example,
                or from MySQL to HSQLDB.
            </p>
            <p>
                <b>You need to make sure you have the persistence property <i>datanucleus.attachSameDatastore</i>
                set to <i>false</i> if using replication</b>
            </p>
            <p>
                <b>Note that the case of replication between two RDBMS of the same type is usually way more efficiently
                replicated using the capabilities of the datastore itself</b>
            </p>
            <p>
                The following sample code will replicate all objects of type <i>Product</i> and
                <i>Employee</i> from EMF1 to EMF2. These EMFs are created in the normal way
                so, as mentioned above, EMF1 could be for a MySQL datastore, and EMF2 for XML.
                By default this will replicate the complete object graphs reachable from these
                specified types.
            </p>
            <source><![CDATA[
import org.datanucleus.api.jpa.JPAReplicationManager;

...

JPAReplicationManager replicator = new JPAReplicationManager(emf1, emf2);
replicator.replicate(new Class[]{Product.class, Employee.class});
            ]]></source>
        </section>
	</body>
</document>